{"version":3,"sources":["../../../../../../Desktop/worflow-app/lib/prisma.ts","../../../../../../Desktop/worflow-app/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../../../Desktop/worflow-app/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../../../Desktop/worflow-app/actions/auth-actions.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as { prismaDbV2: PrismaClient }\n\nexport const prisma = globalForPrisma.prismaDbV2 || new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prismaDbV2 = prisma\n","/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","\"use server\"\n\nimport { signIn } from \"@/auth\"\nimport { prisma } from \"@/lib/prisma\"\nimport { AuthError } from \"next-auth\"\nimport bcrypt from \"bcryptjs\"\nimport { z } from \"zod\"\n\nconst loginSchema = z.object({\n    email: z.string().email(),\n    password: z.string().min(1, \"Password is required\"),\n})\n\nexport async function authenticate(\n    prevState: string | undefined,\n    formData: FormData,\n) {\n    try {\n        console.log(\"Action: Attempting sign in\")\n        await signIn(\"credentials\", Object.fromEntries(formData))\n        console.log(\"Action: Sign in successful (should not be reached if redirecting)\")\n    } catch (error) {\n        console.log(\"Action: Sign in error\", error)\n        if (error instanceof AuthError) {\n            switch (error.type) {\n                case \"CredentialsSignin\":\n                    return \"Invalid credentials.\"\n                default:\n                    return \"Something went wrong.\"\n            }\n        }\n        throw error\n    }\n}\n\nconst registerSchema = z.object({\n    email: z.string().email(),\n    password: z.string().min(6, \"Password must be at least 6 characters\"),\n    name: z.string().min(1, \"Name is required\"),\n})\n\nexport async function register(formData: FormData) {\n    const rawData = Object.fromEntries(formData)\n    const validatedFields = registerSchema.safeParse(rawData)\n\n    if (!validatedFields.success) {\n        return { success: false, message: \"Invalid fields\" }\n    }\n\n    const { email, password, name } = validatedFields.data\n\n    try {\n        const hashedPassword = await bcrypt.hash(password, 10)\n\n        await prisma.user.create({\n            data: {\n                email,\n                password: hashedPassword,\n                name,\n            },\n        })\n\n        return { success: true, message: \"User created\" }\n    } catch (error) {\n        console.error(error)\n        return { success: false, message: \"User already exists or database error\" }\n    }\n}\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"uNAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAIO,IAAM,EAFW,AAEF,WAAgB,UAAU,EAAI,IAAI,EAAA,YAAY,mDCJhB,OAAA,cAAA,CAAA,EAAA,aAAA,oCAC3CA,0BAAAA,qCAAAA,EAAAA,uBAAuB,YAAQ,CAAA,CAAA,IAAA,iCCEjC,SAASC,EAAyBC,CAAc,EACrD,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAQE,MAAM,CAAED,IAAK,CACvC,IAAME,EAASH,CAAO,CAACC,EAAE,CACzB,GAAI,AAAkB,YAAY,OAAvBE,EACT,MAAM,OAAA,cAEL,CAFK,AAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,EAAO;AAAA,oEAAuE,CAAC,EADhJ,oBAAA,OAAA,mBAAA,gBAAA,CAEN,EAEJ,CACF,0EATgBJ,2BAAAA,qCAAAA,6CCDhB,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,oBAOO,eAAe,EAClB,CAA6B,CAC7B,CAAkB,EAElB,GAAI,CACA,QAAQ,GAAG,CAAC,8BACZ,MAAM,CAAA,EAAA,EAAA,MAAM,AAAN,EAAO,cAAe,OAAO,WAAW,CAAC,IAC/C,QAAQ,GAAG,CAAC,oEAChB,CAAE,MAAO,EAAO,CAEZ,GADA,QAAQ,GAAG,CAAC,wBAAyB,GACjC,aAAiB,EAAA,SAAS,CAC1B,CAD4B,EAEnB,sBADD,EAAM,IAAI,CAEV,MAAO,4BAEP,MAAO,uBAGnB,OAAM,CACV,CACJ,CAzBoB,EAAA,CAAC,CAAC,MAAM,CAAC,CACzB,MAAO,EAAA,CAAC,CAAC,MAAM,GAAG,KAAK,GACvB,SAAU,EAAA,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC,EAAG,uBAChC,GAwBA,IAAM,EAAiB,EAAA,CAAC,CAAC,MAAM,CAAC,CAC5B,MAAO,EAAA,CAAC,CAAC,MAAM,GAAG,KAAK,GACvB,SAAU,EAAA,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC,EAAG,0CAC5B,KAAM,EAAA,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC,EAAG,mBAC5B,GAEO,eAAe,EAAS,CAAkB,EAC7C,IAAM,EAAU,OAAO,WAAW,CAAC,GAC7B,EAAkB,EAAe,SAAS,CAAC,GAEjD,GAAI,CAAC,EAAgB,OAAO,CACxB,CAD0B,KACnB,CAAE,SAAS,EAAO,QAAS,gBAAiB,EAGvD,GAAM,OAAE,CAAK,UAAE,CAAQ,MAAE,CAAI,CAAE,CAAG,EAAgB,IAAI,CAEtD,GAAI,CACA,IAAM,EAAiB,MAAM,EAAA,OAAM,CAAC,IAAI,CAAC,EAAU,IAUnD,OARA,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACrB,KAAM,OACF,EACA,SAAU,OACV,CACJ,CACJ,GAEO,CAAE,SAAS,EAAM,QAAS,cAAe,CACpD,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,GACP,CAAE,SAAS,EAAO,QAAS,uCAAwC,CAC9E,CACJ,iCAtDsB,EA4BA,IA5BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA4BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA","ignoreList":[1,2]}